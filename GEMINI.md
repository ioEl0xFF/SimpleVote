# Gemini向けSimpleVoteプロジェクトガイドライン

このドキュメントは、SimpleVoteプロジェクトの主要な側面を概説し、Geminiエージェントがコードベースを効果的に理解、変更、および保守するために必要なコンテキストを提供します。

## プロジェクト概要

SimpleVoteは、スマートコントラクトにSolidity、フロントエンドにReactを使用して構築された、投票用の分散型アプリケーション（dApp）です。コンパイル、テスト、デプロイを含むスマートコントラクト開発には、Hardhatフレームワークを活用しています。

### 主な機能:

-   **3種類の投票コントラクト**:
    -   `SimpleVote`: 基本的な「賛成/反対」投票。
    -   `DynamicVote`: オーナーが動的に選択肢を追加できる。
    -   `WeightedVote`: ステーキングされたERC20トークンに基づいて重み付けされた投票を可能にする`DynamicVote`の拡張。
-   **投票管理コントラクト**:
    -   `PollManager`: すべての投票コントラクトの作成とリストを管理します。
-   **Reactフロントエンド**:
    -   `simple-vote-ui`: MetaMaskを介してスマートコントラクトと対話するためのViteベースのReactアプリケーション。

### 技術スタック:

-   **スマートコントラクト**: Solidity, Hardhat, OpenZeppelin Contracts
-   **フロントエンド**: React, Vite, ethers.js, Tailwind CSS
-   **テスト**: Chai, Mocha (Hardhat Toolbox)

## ディレクトリ構造:

```
contracts/          Solidityスマートコントラクト
scripts/            デプロイスクリプト
test/               コントラクトテストコード
simple-vote-ui/     Reactフロントエンド
```

## セットアップと開発:

1.  **前提条件**: Node.js 18以上が必要です。
2.  **環境設定**: リポジトリのルートに以下の内容で`.env`ファイルを作成します。
    ```
    # 目的のネットワークのRPCエンドポイント（例：Polygon Amoyテストネット）
    API_URL="https://rpc-amoy.polygon.polygon.technology/"

    # コントラクトのデプロイに使用するアカウントの秘密鍵
    PRIVATE_KEY="YOUR_PRIVATE_KEY"
    ```
3.  **依存関係のインストール**:
    ```bash
    npm install
    ```
4.  **スマートコントラクトのコンパイルとテスト**:
    ```bash
    # コントラクトをコンパイル
    npm run compile

    # テストを実行
    npm test
    ```
5.  **コントラクトのデプロイ**:
    リポジトリはPolygon Amoyテストネット（`amoy`ネットワーク）用に設定されています。`.env`ファイルを設定した後、以下でデプロイします。
    ```bash
    npx hardhat run scripts/deploy.js --network amoy
    ```
    *注*: デプロイが成功すると、フロントエンド統合のために`PollManager`と`MockERC20`コントラクトアドレスが`simple-vote-ui/src/constants.js`に自動的に更新されます。
6.  **フロントエンドの起動**:
    フロントエンドディレクトリに移動し、依存関係をインストールして開発サーバーを起動します。
    ```bash
    cd simple-vote-ui
    npm install
    npm run dev
    ```
    ブラウザでアプリケーションにアクセスし（例：`http://localhost:5173/`）、MetaMaskウォレットを接続します。

## 貢献ガイドライン:

このリポジトリに変更を加える際は、以下のルールに従ってください。

### コードスタイル:

-   インデントには常に**4スペース**を使用してください。
-   可能な限り日本語でコメントを記述し、初心者にも分かりやすい説明を提供してください。
-   不要な外部パッケージの追加は避けてください。

### テストとLint:

-   コントラクトまたはスクリプトを変更した後、常に`npm test`を実行してすべてのテストがパスすることを確認してください。
-   `simple-vote-ui`内の変更については、そのディレクトリで`npm run lint`を実行してください。

### コミットメッセージ:

-   `feat:`, `fix:`, `docs:`などのプレフィックスで始め、簡潔な日本語の要約を続けてください。
-   複数行にわたる詳細な説明は、空行の後に記述してください。

### プルリクエスト:

-   プルリクエストの本文に、変更の要約とテスト結果を日本語で含めてください。
-   レビューを容易にするために、必要に応じてスクリーンショットやログを添付してください。

## ライセンス:

このプロジェクトはMITライセンスの下でリリースされています。